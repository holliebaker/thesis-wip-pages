<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.4 Computing the refinements | Thesis</title>
  <meta name="description" content="Hollie Baker’s thesis" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="7.4 Computing the refinements | Thesis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Hollie Baker’s thesis" />
  <meta name="github-repo" content="holliebaker/thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.4 Computing the refinements | Thesis" />
  
  <meta name="twitter:description" content="Hollie Baker’s thesis" />
  

<meta name="author" content="Hollie" />


<meta name="date" content="2024-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="7.3-implementation-details.html"/>
<link rel="next" href="8-frontier-condition.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Thesis: CAD with monotone cells</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Cylindrical algebraic decompositions with monotone cells</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-things-to-explain.html"><a href="1.1-things-to-explain.html"><i class="fa fa-check"></i><b>1.1</b> Things to explain</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-bits-and-pieces.html"><a href="2-bits-and-pieces.html"><i class="fa fa-check"></i><b>2</b> Bits and Pieces</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-definitions-that-dont-quite-fit-anywhere-else..html"><a href="2.1-definitions-that-dont-quite-fit-anywhere-else..html"><i class="fa fa-check"></i><b>2.1</b> Definitions that don’t quite fit anywhere else.</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-definition-of-the-cad.html"><a href="2.2-definition-of-the-cad.html"><i class="fa fa-check"></i><b>2.2</b> Definition of the CAD</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-background-cad.html"><a href="3-background-cad.html"><i class="fa fa-check"></i><b>3</b> Background: CAD</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="3-background-cad.html"><a href="3-background-cad.html#constructing-a-cad"><i class="fa fa-check"></i><b>3.0.1</b> Constructing a CAD</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-intro.html"><a href="4-intro.html"><i class="fa fa-check"></i><b>4</b> Introduction</a></li>
<li class="chapter" data-level="5" data-path="5-smooth-stratification.html"><a href="5-smooth-stratification.html"><i class="fa fa-check"></i><b>5</b> Smooth Stratification</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="5-smooth-stratification.html"><a href="5-smooth-stratification.html#description-of-the-algorithm"><i class="fa fa-check"></i><b>5.0.1</b> Description of the algorithm</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-quasi-affine-cells.html"><a href="6-quasi-affine-cells.html"><i class="fa fa-check"></i><b>6</b> Quasi-affine cells</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-computing-the-smooth-2-dimensional-locus-of-v.html"><a href="6.1-computing-the-smooth-2-dimensional-locus-of-v.html"><i class="fa fa-check"></i><b>6.1</b> Computing the smooth 2-dimensional locus of <span class="math inline">\(V\)</span></a></li>
<li class="chapter" data-level="6.2" data-path="6.2-ensuring-that-every-cell-is-the-graph-of-a-quasi-affine-map.html"><a href="6.2-ensuring-that-every-cell-is-the-graph-of-a-quasi-affine-map.html"><i class="fa fa-check"></i><b>6.2</b> Ensuring that every cell is the graph of a quasi-affine map</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-monotone-cells.html"><a href="7-monotone-cells.html"><i class="fa fa-check"></i><b>7</b> Monotone Cells</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-two-dimensional-semi-monotone-sectors.html"><a href="7.1-two-dimensional-semi-monotone-sectors.html"><i class="fa fa-check"></i><b>7.1</b> Two-dimensional semi-monotone sectors</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-two-dimensional-semi-monotone-sectors.html"><a href="7.1-two-dimensional-semi-monotone-sectors.html#semi-monotone-sets"><i class="fa fa-check"></i><b>7.1.1</b> Two-dimensional semi-monotone sets</a></li>
<li class="chapter" data-level="7.1.2" data-path="7.1-two-dimensional-semi-monotone-sectors.html"><a href="7.1-two-dimensional-semi-monotone-sectors.html#sec:lagrange-refinement"><i class="fa fa-check"></i><b>7.1.2</b> Finding the critical points of <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="7.1.3" data-path="7.1-two-dimensional-semi-monotone-sectors.html"><a href="7.1-two-dimensional-semi-monotone-sectors.html#sec:sub-cad"><i class="fa fa-check"></i><b>7.1.3</b> Working with sub-decompositions above a 0-cell</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-two-dimensional-monotone-sections.html"><a href="7.2-two-dimensional-monotone-sections.html"><i class="fa fa-check"></i><b>7.2</b> Two-dimensional monotone sections</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-two-dimensional-monotone-sections.html"><a href="7.2-two-dimensional-monotone-sections.html#case-1-2-le-j-le-alpha---1"><i class="fa fa-check"></i><b>7.2.1</b> Case 1: <span class="math inline">\(2 \le j \le \alpha - 1\)</span></a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-two-dimensional-monotone-sections.html"><a href="7.2-two-dimensional-monotone-sections.html#case-2-alpha-1-le-j-le-n"><i class="fa fa-check"></i><b>7.2.2</b> Case 2: <span class="math inline">\(\alpha + 1 \le j \le n\)</span></a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-two-dimensional-monotone-sections.html"><a href="7.2-two-dimensional-monotone-sections.html#critical-points-of-the-top-and-bottom-of-c"><i class="fa fa-check"></i><b>7.2.3</b> Critical points of the top and bottom of <span class="math inline">\(C\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-implementation-details.html"><a href="7.3-implementation-details.html"><i class="fa fa-check"></i><b>7.3</b> Implementation Details</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="7.3-implementation-details.html"><a href="7.3-implementation-details.html#algorithm"><i class="fa fa-check"></i><b>7.3.1</b> Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7.4-computing-the-refinements.html"><a href="7.4-computing-the-refinements.html"><i class="fa fa-check"></i><b>7.4</b> Computing the refinements</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-frontier-condition.html"><a href="8-frontier-condition.html"><i class="fa fa-check"></i><b>8</b> Frontier Condition</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-geteral-frontier-algorithm.html"><a href="8.1-geteral-frontier-algorithm.html"><i class="fa fa-check"></i><b>8.1</b> Geteral Frontier Algorithm</a></li>
<li class="chapter" data-level="8.2" data-path="8.2-lazard-3d.html"><a href="8.2-lazard-3d.html"><i class="fa fa-check"></i><b>8.2</b> Lazard 3d</a></li>
<li class="chapter" data-level="8.3" data-path="8.3-geteralisation-of-lazard.html"><a href="8.3-geteralisation-of-lazard.html"><i class="fa fa-check"></i><b>8.3</b> Geteralisation of Lazard</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-notation.html"><a href="9-notation.html"><i class="fa fa-check"></i><b>9</b> Notation</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Thesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computing-the-refinements" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Computing the refinements<a href="7.4-computing-the-refinements.html#computing-the-refinements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now describe how to refine the CAD <span class="math inline">\(\cal D\)</span> to be compatible with the refinement points in <span class="math inline">\(\cal R\)</span>.</p>
<p>For <span class="math inline">\(0 \le k \le n\)</span>, consider each refinemen point <span class="math inline">\(\mathbf{c} = (c_1,\ldots,c_{k-1}, c_k) \in {\cal R}_k\)</span>. It is important to note that refinement points appear in ascending order.
Let <span class="math inline">\({\cal D}&#39;\)</span> be the sub-cad of <span class="math inline">\(\mathbb{R}^{n-k}\)</span> above <span class="math inline">\((c_1,\ldots,c_k)\)</span>, which is a <span class="math inline">\((0,\ldots,0)\)</span>-cell of the CAD induced by <span class="math inline">\(\cal D\)</span> on <span class="math inline">\(\mathbb{R}^k\)</span> and let <span class="math inline">\({\cal D}&#39;&#39;\)</span> be the CAD induced by <span class="math inline">\({\cal D}&#39;\)</span> on <span class="math inline">\(\mathbb{R}^{k+1}\)</span>. We want to refine <span class="math inline">\({\cal D}&#39;&#39;\)</span> such that <span class="math inline">\(\mathbf{c}\)</span> is a new <span class="math inline">\((0)\)</span>-cell.
We need only to consider coordinate <span class="math inline">\(k+1\)</span> of <span class="math inline">\(\mathbf{c}\)</span>. Denote it by <span class="math inline">\(c_{k+1}\)</span>.
For each <span class="math inline">\((0)\)</span>-cell <span class="math inline">\(b_{k+1}\)</span> of <span class="math inline">\({\cal D}&#39;&#39;\)</span>, compute <span class="math inline">\(s := \sign(b_{k+1} - c_{k+1})\)</span>. If <span class="math inline">\(s \le 0\)</span>, consider the next <span class="math inline">\((0)\)</span>-cell in <span class="math inline">\({\cal D}&#39;&#39;\)</span>. Otherwise, <span class="math inline">\(s &gt; 0\)</span> and there is a <span class="math inline">\((1)\)</span>-cell <span class="math inline">\(C\)</span> in <span class="math inline">\({\cal D}&#39;&#39;\)</span> such that <span class="math inline">\(c_{k+1} \in C\)</span>. This is the cell we need to refine.
Make two new copies of <span class="math inline">\(C\)</span>, so that we have three identical cells <span class="math inline">\(C_1,C_2,C_3\)</span>. Recall that, to each cell belongs a sample point and possibly some other information. E.g., in QEPCAD, each cell has a set of signs of projection factors, which should remain unchanged, and a positional index which describes where in the CAD the cell can be found. Let <span class="math inline">\(C_1\)</span> have positional index <span class="math inline">\((j_1,\ldots,j_k,j_{k+1})\)</span>. New cells <span class="math inline">\(C_2\)</span> and <span class="math inline">\(C_3\)</span> should have positional indeices <span class="math inline">\((j_1,\ldots,j_k,j_{k+1} + 1\)</span> and <span class="math inline">\((j_1,\ldots,j_k,j_{k+1}+2)\)</span> respectively. For each eisting cell with positional index <span class="math inline">\((l_1,\ldots,l_k,l_{k+1})\)</span> with <span class="math inline">\(l_k+1 &gt; j_{k+1}\)</span>, the index should be updated to <span class="math inline">\((l_1,\ldots,l_k,l_{k+1} + 2\)</span>. We now need to update the sample points. The sample point of the sector cell <span class="math inline">\(C_2\)</span> should be <span class="math inline">\(\mathbf{c}\)</span>. This might turn out to be the case by chance. In this case, there is nothing to be done with <span class="math inline">\(C_2\)</span> and the sample points of sector cells <span class="math inline">\(C_1\)</span> and <span class="math inline">\(C_3\)</span> are incorrect. Otherwise, <span class="math inline">\(c_{k+1}\)</span> is either an element of <span class="math inline">\(C_1\)</span> (sample point of <span class="math inline">\(C_1\)</span> is already correct) or <span class="math inline">\(c_{k+1}\)</span> is an element of <span class="math inline">\(C_3\)</span> (sample point of <span class="math inline">\(C_3\)</span> is already correct). Let <span class="math inline">\(C\)</span> be the open interval <span class="math inline">\((a_1,a_2)\)</span>. If the sample point of <span class="math inline">\(C_1\)</span> needs to be updated, then set it to <span class="math inline">\((a_1 + c_{k+1}) / 2\)</span> and if the sample point of <span class="math inline">\(C_3\)</span> needs updating, then set it to <span class="math inline">\((a_2 + c_{k+1}) / 2\)</span>. Observe that, if we have updated the sample point of a cell <span class="math inline">\(C\)</span>, then the sample points of all cells in the sub-CAD above <span class="math inline">\(C\)</span> are now incorrect. Since polynomials are delineable over the original cell, then they will be delineable over the smaller cells in the refinement, so we simply need to run the sample point computing part of the lifting phase recursively on the stack above <span class="math inline">\(C\)</span>. This involves evaluating each level <span class="math inline">\(k+1\)</span> projection factor <span class="math inline">\(f\)</span> ot the new sample point <span class="math inline">\(\mathbf{b}\)</span> and finding the roots of the (possibly algebraic) univariate polynomial <span class="math inline">\(f(\mathbf{b},x_n)\)</span>.</p>
<p>Repeating this process with each refinement point in <span class="math inline">\(\mathbf{R}_k\)</span>, we obtain the refinement described in <span class="citation">(Basu, Gabrielov, and Vorobjov <a href="#ref-bgv15" role="doc-biblioref">2015</a>, Lemma 3.11)</span>.</p>

</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references hanging-indent">
<div id="ref-bgv15">
<p>Basu, Saugata, Andrei Gabrielov, and Nicolai Vorobjov. 2015. “Triangulations of Monotone Families I: Two-Dimensional Families.” <em>Proceedings of the London Mathematical Society</em> 111 (5): 1013–51.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="7.3-implementation-details.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="8-frontier-condition.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.bath.ac.uk/hb581/thesis/edit/master/03-2-monotone-cells.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["thesis.pdf", "thesis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
