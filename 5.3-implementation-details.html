<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.3 Implementation Details | Thesis</title>
  <meta name="description" content="Hollie Baker’s thesis" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="5.3 Implementation Details | Thesis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Hollie Baker’s thesis" />
  <meta name="github-repo" content="holliebaker/thesis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.3 Implementation Details | Thesis" />
  
  <meta name="twitter:description" content="Hollie Baker’s thesis" />
  

<meta name="author" content="Hollie" />


<meta name="date" content="2023-11-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="5.2-two-dimensional-monotone-sections.html"/>
<link rel="next" href="5.4-computing-the-refinements.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Thesis: CAD with monotone cells</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Cylindrical algebraic decompositions with monotone cells</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-things-to-explain.html"><a href="1.1-things-to-explain.html"><i class="fa fa-check"></i><b>1.1</b> Things to explain</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-bits-and-pieces.html"><a href="2-bits-and-pieces.html"><i class="fa fa-check"></i><b>2</b> Bits and Pieces</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-definitions-that-dont-quite-fit-anywhere-else..html"><a href="2.1-definitions-that-dont-quite-fit-anywhere-else..html"><i class="fa fa-check"></i><b>2.1</b> Definitions that don’t quite fit anywhere else.</a></li>
<li class="chapter" data-level="2.2" data-path="2.2-definition-of-the-cad.html"><a href="2.2-definition-of-the-cad.html"><i class="fa fa-check"></i><b>2.2</b> Definition of the CAD</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-intro.html"><a href="3-intro.html"><i class="fa fa-check"></i><b>3</b> Introduction</a></li>
<li class="chapter" data-level="4" data-path="4-quasi-affine-cells.html"><a href="4-quasi-affine-cells.html"><i class="fa fa-check"></i><b>4</b> Quasi-affine cells</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-computing-the-smooth-2-dimensional-locus-of-v.html"><a href="4.1-computing-the-smooth-2-dimensional-locus-of-v.html"><i class="fa fa-check"></i><b>4.1</b> Computing the smooth 2-dimensional locus of <span class="math inline">\(V\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="4.2-ensuring-that-every-cell-is-the-graph-of-a-quasi-affine-map.html"><a href="4.2-ensuring-that-every-cell-is-the-graph-of-a-quasi-affine-map.html"><i class="fa fa-check"></i><b>4.2</b> Ensuring that every cell is the graph of a quasi-affine map</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-monotone-cells.html"><a href="5-monotone-cells.html"><i class="fa fa-check"></i><b>5</b> Monotone Cells</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-two-dimensional-semi-monotone-sectors.html"><a href="5.1-two-dimensional-semi-monotone-sectors.html"><i class="fa fa-check"></i><b>5.1</b> Two-dimensional semi-monotone sectors</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-two-dimensional-semi-monotone-sectors.html"><a href="5.1-two-dimensional-semi-monotone-sectors.html#semi-monotone-sets"><i class="fa fa-check"></i><b>5.1.1</b> Two-dimensional semi-monotone sets</a></li>
<li class="chapter" data-level="5.1.2" data-path="5.1-two-dimensional-semi-monotone-sectors.html"><a href="5.1-two-dimensional-semi-monotone-sectors.html#sec:lagrange-refinement"><i class="fa fa-check"></i><b>5.1.2</b> Finding the critical points of <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="5.1.3" data-path="5.1-two-dimensional-semi-monotone-sectors.html"><a href="5.1-two-dimensional-semi-monotone-sectors.html#sec:sub-cad"><i class="fa fa-check"></i><b>5.1.3</b> Working with sub-decompositions above a 0-cell</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-two-dimensional-monotone-sections.html"><a href="5.2-two-dimensional-monotone-sections.html"><i class="fa fa-check"></i><b>5.2</b> Two-dimensional monotone sections</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="5.2-two-dimensional-monotone-sections.html"><a href="5.2-two-dimensional-monotone-sections.html#case-1-2-le-j-le-alpha---1"><i class="fa fa-check"></i><b>5.2.1</b> Case 1: <span class="math inline">\(2 \le j \le \alpha - 1\)</span></a></li>
<li class="chapter" data-level="5.2.2" data-path="5.2-two-dimensional-monotone-sections.html"><a href="5.2-two-dimensional-monotone-sections.html#case-2-alpha-1-le-j-le-n"><i class="fa fa-check"></i><b>5.2.2</b> Case 2: <span class="math inline">\(\alpha + 1 \le j \le n\)</span></a></li>
<li class="chapter" data-level="5.2.3" data-path="5.2-two-dimensional-monotone-sections.html"><a href="5.2-two-dimensional-monotone-sections.html#critical-points-of-the-top-and-bottom-of-c"><i class="fa fa-check"></i><b>5.2.3</b> Critical points of the top and bottom of <span class="math inline">\(C\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5.3-implementation-details.html"><a href="5.3-implementation-details.html"><i class="fa fa-check"></i><b>5.3</b> Implementation Details</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-implementation-details.html"><a href="5.3-implementation-details.html#algorithm"><i class="fa fa-check"></i><b>5.3.1</b> Algorithm</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-implementation-details.html"><a href="5.3-implementation-details.html#discussion-on-qepcad-sample-points"><i class="fa fa-check"></i><b>5.3.2</b> Discussion on QEPCAD sample points</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-computing-the-refinements.html"><a href="5.4-computing-the-refinements.html"><i class="fa fa-check"></i><b>5.4</b> Computing the refinements</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-frontier-condition.html"><a href="6-frontier-condition.html"><i class="fa fa-check"></i><b>6</b> Frontier Condition</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-geteral-frontier-algorithm.html"><a href="6.1-geteral-frontier-algorithm.html"><i class="fa fa-check"></i><b>6.1</b> Geteral Frontier Algorithm</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-lazard-3d.html"><a href="6.2-lazard-3d.html"><i class="fa fa-check"></i><b>6.2</b> Lazard 3d</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-geteralisation-of-lazard.html"><a href="6.3-geteralisation-of-lazard.html"><i class="fa fa-check"></i><b>6.3</b> Geteralisation of Lazard</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-notation.html"><a href="7-notation.html"><i class="fa fa-check"></i><b>7</b> Notation</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Thesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="implementation-details" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Implementation Details<a href="5.3-implementation-details.html#implementation-details" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now discuss implementation details of this step of the algorithm. First psuedocode is presented.</p>
<div id="algorithm" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Algorithm<a href="5.3-implementation-details.html#algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<hr />
<p><strong>Input:</strong>
<span class="math display">\[({\cal E}, {\cal A})\]</span></p>
<ul>
<li><p><span class="math inline">\(\cal E\)</span>: a cylindrical algebraic decomposition of <span class="math inline">\(\mathbb{R}^{k+n}\)</span>, such that each cell is the graph of a quasi-affine map. Each cell <span class="math inline">\(C\)</span> of <span class="math inline">\(\cal E\)</span> has a truth-value (<em>true</em> or <em>false</em> attached.</p></li>
<li><p><span class="math inline">\({\cal A} = {\cal A}_1,\ldots,{\cal A}_{k+n}\)</span> is the family of projection polynomials where each <span class="math inline">\({\cal A}_i \subset \mathbb{Z}[x_1,\ldots,x_i]\)</span>.</p></li>
</ul>
<p><strong>Output:</strong>
<span class="math display">\[
{\cal R} := \{ {\cal R}_{\mathbf{b}} = \{ c_1,\ldots,c_t \} \subset \mathbb{A}\mid \mathbf{b} \in \mathbb{R}^{k-1} \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \mathbb{R}^k \}
\]</span>
such that, for each <span class="math inline">\({\cal R}_\mathbf{b}\)</span>, intersecting the sub-cad <span class="math inline">\(\cal D\)</span> above <span class="math inline">\(\mathbf{b}\)</span> with straight lines and half-planes of the kind <span class="math inline">\(\{x_1 &lt; c_i \}, \{x_1 = c_i \}, \{x_1 &gt; c_i\}, 1 \le i \le t\)</span> results in a refinement of <span class="math inline">\(\cal D\)</span> such that each true cell of <span class="math inline">\(\cal D\)</span> with dimension at most <span class="math inline">\(2\)</span> is monotone.</p>
<hr />
<p>First, define a subroutine
<span class="math display">\[{\rm sub}_{\mathbf{y}} (g) \mid g \in \mathbb{Z}[y_1,\ldots,y_m,x_{m+1},\ldots,x_n], \mathbf{y} \in \mathbb{A}^m, m &lt; n,\]</span>
which computes <span class="math inline">\(h := g(\mathbf{y}) \in \mathbb{A}[x_{m+1},\ldots,x_m]\)</span> and returns the normalised polynomial of <span class="math inline">\(h\)</span>, in <span class="math inline">\(\mathbb{Z}[x_{m+1},\ldots,x_n]\)</span> (see Section <a href="5.1-two-dimensional-semi-monotone-sectors.html#sec:sub-cad">5.1.3</a>).</p>
<p>It will be convenient to overload this operator and write <span class="math inline">\({\rm sub}_{\mathbf{y}} (L)\)</span>, where <span class="math inline">\(L\)</span> is a set (or list) of polynomials to mean <span class="math inline">\(\{ {\rm sub}_{\mathbf{y}} (g) \mid g \in L \}\)</span>.</p>
<p>Now define a structure to store refinement polynomials
<span class="math display">\[
{\cal F} := \{ {\cal F}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \mathbb{R}^{k-1}, k &gt; 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \mathbb{R}^{k-1} \}
\]</span>
and refinement points
<span class="math display">\[
{\cal R} := \{ {\cal R}_{\mathbf{b}} := \emptyset \mid \mathbf{b} \in \mathbb{R}^{k-1}, k &gt; 0 \text{ is a } (0,\ldots,0) \text{-cell in the decomposition induced by } {\cal E} \text{ on } \mathbb{R}^{k-1} \}
\]</span>
<em>(Note: for each <span class="math inline">\((0,\ldots,0)\)</span>-cell <span class="math inline">\(\mathbf{b}\)</span>, <span class="math inline">\({\cal F}_\mathbf{b}\)</span> is a set of univariate polynomials, <span class="math inline">\({\cal R}_{\mathbf{b}}\)</span> is the set of roots of polynomials <span class="math inline">\({\cal F}_\mathbf{b}\)</span>.)</em></p>
<p>Let <span class="math inline">\(\mathbf{b}\)</span> be a <span class="math inline">\((0,\ldots,0)\)</span>-cell of the decomposition induced by <span class="math inline">\(\cal E\)</span> on <span class="math inline">\(\mathbb{R}^{k-1}, k &gt; 0\)</span>. Let <span class="math inline">\(\cal D\)</span> be the sub-decomposition of <span class="math inline">\(\mathbb{R}^n\)</span> of <span class="math inline">\(\cal E\)</span> above <span class="math inline">\(\mathbf{b}\)</span>.</p>
<p>For each <em>true</em> cell <span class="math inline">\(C\)</span> of <span class="math inline">\(\cal D\)</span>. If <span class="math inline">\(\dim(C) &gt; 2\)</span>, then <strong>fail</strong>.
Otherwise let <span class="math inline">\(C\)</span> have index
<span class="math display">\[
(0,\ldots,0,1,i_{k+1},\ldots,i_{k+n})
\]</span>
in <span class="math inline">\(\cal E\)</span>, and let <span class="math inline">\(\alpha\)</span> be the smallest among <span class="math inline">\(x+1,\ldots,k+n\)</span> such that <span class="math inline">\(i_{k+1} = \ldots = i_{\alpha - 1} = 0\)</span> and <span class="math inline">\(i_\alpha = 1\)</span>,
do:</p>
<ul>
<li><p>Let</p>
<ul>
<li><p><span class="math inline">\(C_0 := {\operatorname{proj}_{\mathbb{R}^{k-1}}}(C)\)</span>,</p>
<p>(<em>Note: if <span class="math inline">\(k = 1\)</span>, then <span class="math inline">\(C_0\)</span> is the unique cell, <span class="math inline">\(\mathbf{0}\)</span>, in the CAD of <span class="math inline">\(\mathbb{R}^0\)</span>, and <span class="math inline">\({\rm sub}_\mathbf{0} (g) = g\)</span>.</em>)</p></li>
<li><p><span class="math inline">\(\mathbf{b} \in \mathbb{A}^{k-1}\)</span> be the sample point of <span class="math inline">\(C_0\)</span></p></li>
<li><p><span class="math inline">\({\cal G} := {\rm sub}_{\mathbf{b}} \{ (g_{k+1},\ldots,g_{\alpha-1}) \mid k+1 \le i \le \alpha - 1, g_i \in {\cal A}_i, g_i(\mathbf{x}) = 0 \ \forall \mathbf{x} \in {\operatorname{proj}_{\mathbb{R}^{\alpha-1}}}(C) \}\)</span>,</p></li>
<li><p><span class="math inline">\(C&#39; := {\operatorname{proj}_{\mathbb{R}^{\alpha}}}(C)\)</span>.</p></li>
</ul></li>
<li><p><span class="math inline">\(C&#39;_T\)</span> and <span class="math inline">\(C&#39;_B\)</span> be the top and bottom, respectively, of sector cell <span class="math inline">\(C&#39;\)</span>.</p></li>
</ul>
<p>(<em>Note: If <span class="math inline">\(C&#39;\)</span> is not bounded from above (resp. below) by a continuous definable function, then let <span class="math inline">\(C&#39;_T := \emptyset\)</span> (resp <span class="math inline">\(C&#39;_B\)</span>) and skip any computations involving <span class="math inline">\(C&#39;_T\)</span> (resp <span class="math inline">\(C&#39;_B\)</span>).)</em></p>
<ul>
<li><p>Let <span class="math inline">\(j = \alpha\)</span> and do:</p>
<ul>
<li><p>**(*)** For <span class="math inline">\(\delta \in \{B, T\}\)</span>, if <span class="math inline">\(C_\delta\)</span> is not empty, do:</p>
<ul>
<li><p>Let <span class="math inline">\({\rm sub}_{\mathbf{b}} (g_j) \in \mathbb{Z}[x_{k+1,\ldots,x_j}]\)</span> be such that <span class="math inline">\(g_\alpha(\mathbf{x}) = 0\)</span> for all $ <span class="math inline">\(C&#39;_\delta\)</span>.</p></li>
<li><p>Compute
<span class="math display">\[
f_\delta := \det\begin{pmatrix}\dfrac{\partial g_{k+1}}{\partial x_{k}} &amp; \cdots &amp; \dfrac{\partial g_{j-1}}{\partial x_{k}} &amp; \dfrac{\partial g_{j}}{\partial x_{k}}\\
\vdots &amp;  &amp;  &amp; \vdots\\
\dfrac{\partial g_{k+1}}{\partial x_{j-1}} &amp; \cdots &amp; \dfrac{\partial g_{j-1}}{\partial x_{j-1}} &amp; \dfrac{\partial g_{j}}{\partial x_{j-1}}
\end{pmatrix},
\]</span>
from Equation <a href="5.1-two-dimensional-semi-monotone-sectors.html#eq:jacobi-det">(5.6)</a>, using constraints <span class="math inline">\(g_{k+1},\ldots,g_{\alpha+1}\)</span>, and discarding denominators <span class="math inline">\(\partial g_\alpha / \partial x_\alpha\)</span> of the total derivatives in the last column.</p></li>
</ul></li>
<li><p>Let <span class="math display">\[{\cal H} := \{ g_{k+1},\ldots,g_{j-1}, f_B, f_T \}\]</span>
be a set of polynomials and compute
<span class="math display">\[
{\cal F}_{\mathbf{b}} := {\cal F}_{\mathbf{b}} \cup {\operatorname{proj}_{\mathbb{R}^{1}}}({\cal H}) \subset \mathbb{Z}[x_k].
\]</span></p></li>
<li><p>If <span class="math inline">\(j &lt; n\)</span>, then</p>
<ul>
<li><p>Add <span class="math inline">\(g_j\)</span> to <span class="math inline">\(\cal G\)</span>, i.e., let
<span class="math display">\[
{\cal G} := {\cal G} \cup \{ g_j \}.
\]</span></p></li>
<li><p>If <span class="math inline">\(j \ne \alpha\)</span>, let
<span class="math display">\[
C&#39; := {\operatorname{proj}_{\mathbb{R}^{j}}}(C)
\]</span>
and refine <span class="math inline">\(C&#39;\)</span> into section cells such that <span class="math inline">\(C&#39;_T\)</span> is either empty or the graph of a continuous function. I.e.,
<span class="math display">\[
...
\]</span></p></li>
</ul></li>
</ul></li>
<li><p>For each <span class="math inline">\((0,\ldots,0)\)</span>-cell <span class="math inline">\(\mathbf{b} \in \mathbb{A}^k\)</span>, consider
<span class="math display">\[
{\cal F}_{\mathbf{b}} \in {\cal F} \in \mathbb{Z}[k],
\]</span>
compute
<span class="math display">\[
{\cal R}_{\mathbf{b}} := (c_1,\ldots,c_t)
\]</span>
by isolating the real roots of polynomials in <span class="math inline">\({\cal F}_{\mathbf{b}}\)</span>.</p></li>
<li><p>Return the family <span class="math inline">\({\cal R}\)</span> of refinement poits.</p></li>
</ul>
<hr />
<p><strong>TODO</strong>
- what if <span class="math inline">\(f_j\)</span> does not exist
- what if <span class="math inline">\(\alpha = k+1\)</span></p>
</div>
<div id="discussion-on-qepcad-sample-points" class="section level3 hasAnchor" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Discussion on QEPCAD sample points<a href="5.3-implementation-details.html#discussion-on-qepcad-sample-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Subcad -&gt; substitute
i.e., we want polynomials only in x_1, so we bus in the base cell <span class="math inline">\(c\)</span>.</p>
<p>present the pseudocode.
talk about how refinement points are nothing but sample points of new cells.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5.2-two-dimensional-monotone-sections.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="5.4-computing-the-refinements.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.bath.ac.uk/hb581/thesis/edit/master/03-2-monotone-cells.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["thesis.pdf", "thesis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
